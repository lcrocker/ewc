This is a still older (but probably mostly working) verson of the code.
It's keep here as a reference while I move it to the new codebase.

